document.addEventListener("DOMContentLoaded",function(){function e(e,t="info",n=null){const o=(new Date).toISOString(),s={timestamp:o,level:t,message:e,data:n,userAgent:navigator.userAgent,url:window.location.href,referrer:document.referrer};console.log(`[${o}] [${t.toUpperCase()}] ${e}`,n||"");try{const e=JSON.parse(localStorage.getItem("elemento-contact-logs")||"[]");e.push(s),e.length>50&&e.shift(),localStorage.setItem("elemento-contact-logs",JSON.stringify(e))}catch(e){console.warn("Could not store log entry:",e)}}let t=0,n=0;let o=0,s=Date.now();e("Contact form script initialized","info",{formLoadTime:s,userAgent:navigator.userAgent,screenResolution:`${screen.width}x${screen.height}`,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone}),document.addEventListener("mousemove",()=>{o++,o%10==0&&e("User interaction detected","debug",{userInteractions:o,type:"mousemove"})}),document.addEventListener("keypress",()=>{o++,e("User interaction detected","debug",{userInteractions:o,type:"keypress"})}),document.addEventListener("click",()=>{o++,e("User interaction detected","debug",{userInteractions:o,type:"click"})});const i=document.getElementById("message"),r=document.getElementById("charCount");i&&r&&i.addEventListener("input",function(){const t=this.value.length;r.textContent=t,e("Message character count updated","debug",{charCount:t,maxLength:1e3}),r.style.color=t>1e3?"var(--error-color)":"var(--text-secondary)"});const a=document.getElementById("contactForm");function d(t){e("Showing error message","warn",{message:t});const n=document.getElementById("errorMessage");n&&(n.innerHTML=`<p>${t}</p>`,n.classList.add("show"),setTimeout(()=>{n.classList.remove("show"),e("Error message hidden","debug")},5e3))}a&&a.addEventListener("submit",function(i){i.preventDefault(),e("Form submission attempt started","info",{formSubmissionAttempts:t,timeSinceLastSubmission:Date.now()-n});const r=Date.now();if(r-n<5e3)return e("Rate limiting triggered","warn",{timeSinceLastSubmission:r-n}),void d("Please wait before submitting again.");if(t>=3)return e("Maximum submission attempts reached","error",{attempts:t,maxAttempts:3}),void d("Too many submission attempts. Please try again later.");if(function(){const t=Date.now()-s,n=o/(t/1e3),i=[];t<5e3&&i.push("too_fast"),o<3&&i.push("no_interaction"),n<.1&&i.push("low_interaction"),navigator.webdriver&&i.push("webdriver"),navigator.plugins.length||i.push("no_plugins"),navigator.languages.length||i.push("no_languages");const r=i.length>2;return e("Bot detection analysis","info",{timeOnPage:t,userInteractions:o,interactionRate:n,indicators:i,isBot:r,webdriver:navigator.webdriver,plugins:navigator.plugins.length,languages:navigator.languages.length}),r}())return e("Bot detection triggered","warn",{userInteractions:o,timeOnPage:r-s}),void d("Suspicious activity detected. Please try again.");if(!function(){const t=document.getElementById("contactForm");if(!t)return e("Form not found","error"),!1;const n=t.querySelectorAll("[required]");let o=!0;const s=[];e("Starting form validation","info",{requiredFieldsCount:n.length}),n.forEach(t=>{const n=t.value.trim();e("Validating field","debug",{fieldName:t.name,fieldValue:n,hasValue:!!n}),n?t.style.borderColor="":(o=!1,t.style.borderColor="#DC3545",s.push(`Missing required field: ${t.name}`),e("Validation error","warn",{field:t.name,error:"missing_required"}))});const i=document.getElementById("email");if(i){const t=i.value.trim();t&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)&&(o=!1,i.style.borderColor="#DC3545",s.push("Invalid email format"),e("Validation error","warn",{field:"email",error:"invalid_format",value:t}))}const r=document.getElementById("message");if(r){const t=r.value.trim();t&&t.length<10&&(o=!1,r.style.borderColor="#DC3545",s.push("Message too short"),e("Validation error","warn",{field:"message",error:"too_short",length:t.length}))}return e("Form validation completed",o?"info":"warn",{isValid:o,errors:s,totalErrors:s.length}),o}())return e("Form validation failed","warn"),void d("Please complete all required fields correctly.");e("Form validation passed, preparing submission","info");const a=document.getElementById("submitBtn");a.disabled=!0,a.textContent="Sending...";const c=document.createElement("input");c.type="hidden",c.name="security_data";const l={timestamp:r,userInteractions:o,timeOnPage:r-s,userAgent:navigator.userAgent,screenResolution:`${screen.width}x${screen.height}`,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone};c.value=JSON.stringify(l),this.appendChild(c),e("Submitting form to Web3Forms","info",{action:this.action,securityData:l}),fetch(this.action,{method:"POST",body:new FormData(this)}).then(t=>{if(e("Web3Forms response received","info",{status:t.status,statusText:t.statusText}),!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return t.json()}).then(t=>{e("Web3Forms response parsed","info",{success:t.success,data:t}),t.success?(e("Form submission successful","info",{data:t}),document.getElementById("contactForm").style.display="none",document.getElementById("successMessage").classList.add("show")):(e("Form submission failed","error",{data:t}),d("Submission failed. Please try again."),a.disabled=!1,a.textContent="Send Message")}).catch(t=>{e("Form submission error","error",{error:t.message,stack:t.stack}),d("Submission failed. Please try again."),a.disabled=!1,a.textContent="Send Message"}),t++,n=r,e("Form submission attempt completed","info",{attempts:t,lastSubmissionTime:r})}),document.addEventListener("visibilitychange",function(){e("Page visibility changed","debug",{hidden:document.hidden,visibilityState:document.visibilityState})});const c=new IntersectionObserver(t=>{t.forEach(t=>{t.isIntersecting&&e("Contact form became visible","info",{intersectionRatio:t.intersectionRatio,boundingClientRect:t.boundingClientRect})})}),l=document.querySelector(".inline-form-container");l&&c.observe(l),e("Contact form script setup completed","info")});